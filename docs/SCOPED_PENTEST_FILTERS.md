# Scoped Pentest - Filter Commands Reference

## Overview
The scoped pentest mode now supports comprehensive filtering of vulnerabilities with the ability to:
- Filter by ports (include/exclude)
- Filter by CVSS scores (ranges, greater/less than)
- Filter by severity levels
- Filter by CVE presence
- Apply exception conditions (exclude EXCEPT if...)
- Combine multiple filters

## Filter Command Syntax

### 1. Port Filtering

**Include specific ports only:**
```
filter port 22,80,443,3306
```
Result: Shows only vulnerabilities on ports 22, 80, 443, and 3306

**Exclude specific ports:**
```
exclude port 8080,3000,8443
```
Result: Removes vulnerabilities on ports 8080, 3000, and 8443

**Exclude port with exception:**
```
exclude port 80 if cvss > 8
```
Result: Excludes port 80 EXCEPT for vulnerabilities with CVSS >= 8.0

```
exclude port 80 if severity critical,high
```
Result: Excludes port 80 EXCEPT for critical or high severity vulnerabilities

### 2. CVSS Score Filtering

**CVSS greater than:**
```
filter cvss > 7.5
```
Result: Shows only vulnerabilities with CVSS >= 7.5

**CVSS less than:**
```
filter cvss < 5.0
```
Result: Shows only vulnerabilities with CVSS <= 5.0

**CVSS range:**
```
filter cvss 7 10
```
Result: Shows vulnerabilities with CVSS between 7.0 and 10.0

### 3. Severity Filtering

**Include specific severities:**
```
filter severity critical,high
```
Options: critical, high, medium, low, info
Result: Shows only critical and high severity vulnerabilities

### 4. CVE Filtering

**Only vulnerabilities with CVE:**
```
filter cve
```
Result: Shows only vulnerabilities that have a CVE ID assigned

### 5. Managing Filters

**Clear all filters:**
```
reset
```
Result: Removes all active filters and shows original list

### 6. Other Commands

**View vulnerability details:**
```
view 3
```
Result: Displays full details for vulnerability ID 3

**Select vulnerabilities:**
```
1,3,5,7
```
Result: Selects vulnerabilities 1, 3, 5, and 7 for scoped pentest

```
all
```
Result: Selects all currently displayed vulnerabilities

**Return to main menu:**
```
b
```

## Filter Combinations

Filters are applied sequentially and stack together. Each new filter narrows down the results.

### Example 1: High-value targets
```
> filter cvss > 7
(181 vulnerabilities â†’ 16)

> filter port 22,80,443,3306,5432
(16 vulnerabilities â†’ 5)

> filter cve
(5 vulnerabilities â†’ 3)
```
**Result:** Critical vulnerabilities on common ports with known CVEs

### Example 2: Web application focus
```
> filter port 80,443,8080,8443
> filter severity critical,high,medium
> exclude port 8080 if cvss > 8
```
**Result:** Web-related vulnerabilities, excluding port 8080 unless critical

### Example 3: SSH-specific risks
```
> filter port 22
> filter cvss > 7
```
**Result:** High-risk SSH vulnerabilities only

## Real-World Example Session

```
>>> Scoped Pentest Mode (Interactive)
Total vulnerabilities found: 181

ID    | Severity  | CVSS  | Port   | CVE               | Name
------------------------------------------------------------------------------------------------------------------------
1     | Critical  | 10.0  | 8180   | N/A               | Apache Tomcat SEoL (<= 5.5.x)
2     | Critical  | 9.8   | 8009   | CVE-2020-1745     | Apache Tomcat AJP Connector Request Injection
3     | Critical  | 10.0  | 6667   | CVE-2010-2075     | UnrealIRCd Backdoor Detection
...

> filter cvss > 8
âœ“ Applied CVSS filter: >= 8.0
(181 vulnerabilities â†’ 12)

> filter cve
âœ“ Applied filter: Only vulnerabilities with CVE
(12 vulnerabilities â†’ 5)

> view 2
================================================================================
Vulnerability Details - ID: 2
================================================================================
Name:        Apache Tomcat AJP Connector Request Injection (Ghostcat)
CVE:         CVE-2020-1745
CVSS Score:  9.8
Severity:    Critical (4)
Port:        8009
Host:        192.168.79.128

Description:
A file read/inclusion vulnerability was found in AJP connector...

Solution:
Update the AJP configuration to require authorization and/or upgrade...
================================================================================

> 1,2,3
Selected 3 vulnerabilities for scoped pentest
Scoped Ports: [8180, 8009, 6667]

>>> Launching Scoped Agent...
```

## Filter Display

When filters are active, they are displayed at the top:

```
ðŸ” Active Filters:
  1. CVSS >= 8.0
  2. Include ports: [22, 80, 443]
  3. Has CVE
  (181 total â†’ 3 after filters)
```

## Tips

1. **Start broad, then narrow**: Apply filters progressively to understand the data
2. **Use 'view' before selecting**: Review details to ensure targets are correct
3. **Exception conditions are powerful**: Use "exclude EXCEPT if" for nuanced filtering
4. **Combine strategically**: CVSS + ports + CVE = high-confidence targets
5. **Use 'reset' liberally**: Start fresh if filters become too restrictive

## Supported File Formats

The scoped pentest mode now supports:
- **.nessus** - Nessus vulnerability scan files
- **.xml** - Nmap XML scan results
- **.json** - Pre-processed vulnerability data

All formats display CVE IDs, CVSS scores, and full vulnerability details.
