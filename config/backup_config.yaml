target:
  ip: '0'
  description: Metasploitable 2
scanning:
  mode: auto
  nmap_xml: null
  live_scan:
    enabled: true
    arguments: -sV -sC --top-ports 1000 -T4
    output_dir: data/scans
    cache_duration: 3600
  sudo: false
enrichment:
  use_nessus: false
  nessus_file: null
  use_apfa_classifier: false
  agent:
    model_name: intelligent_metasploitable
    decision_strategy: heuristic
    max_steps: 50
    skill_persistence: persist_with_decay
agent:
  model_name: intelligent_metasploitable
  decision_strategy: heuristic
  max_steps: 50
  skill_persistence: persist_with_decay
llm:
  models:
  - name: local-codellama
    provider: ollama
    model: codellama
    endpoint: http://localhost:11434
    temperature: 0.2
    max_tokens: 4096
    timeout: 120
    enabled: true
  - name: dolphin-phi
    provider: ollama
    model: dolphin-phi
    endpoint: http://localhost:11434
    temperature: 0.1
    max_tokens: 8192
    timeout: 120
    enabled: true
  - name: dolphin-llama3
    provider: ollama
    model: dolphin-llama3
    endpoint: http://localhost:11434
    temperature: 0.1
    max_tokens: 8192
    timeout: 120
    enabled: true
  - name: local-llama3
    provider: ollama
    model: llama3
    endpoint: http://localhost:11434
    temperature: 0.1
    max_tokens: 1500
    timeout: 60
    enabled: false
  - name: sherlock
    provider: openrouter
    model: openrouter/openrouter/sherlock-think-alpha
    api_key_env: OPENROUTER_API_KEY
    temperature: 0.1
    max_tokens: 1500
    timeout: 60
    enabled: true
  - name: longcat-flash-chat
    provider: openrouter
    model: meituan/longcat-flash-chat:free
    api_key_env: OPENROUTER_API_KEY
    temperature: 0.1
    max_tokens: 1500
    timeout: 60
    enabled: true
  - name: qwen-free
    provider: openrouter
    model: qwen/qwen-2.5-72b-instruct:free
    api_key_env: OPENROUTER_API_KEY
    temperature: 0.1
    max_tokens: 1500
    timeout: 60
    enabled: true
  - name: phi-free
    provider: openrouter
    model: microsoft/phi-4:free
    api_key_env: OPENROUTER_API_KEY
    temperature: 0.1
    max_tokens: 1500
    timeout: 60
    enabled: true
  retry:
    max_failures_per_model: 3
    rotate_on_failure: true
    retry_with_error_feedback: true
    max_retries: 2
execution:
  mode: cowboy
  timeout: 60
  max_retries: 2
safety:
  require_vm: true
  allowed_targets:
  - 192.168.79.128
  forbidden_commands:
  - rm -rf
  - format
  - del /f
  - dd if=
  - mkfs
  - '> /dev/sda'
  mode:
    type: agent
    agent:
      ranking_strategy: easy_first
      use_rag: true
      use_skill_library: true
      use_metasploit: true
      skill_persistence: persist_with_decay
metasploit:
  enabled: true
  rpc_host: 127.0.0.1
  rpc_port: 55553
  rpc_ssl: false
  username: msf
  password: msf123
  auto_start: false
  module_map: config/msf_modules.yaml
  auto_discover: true
  auto_discover_confidence_threshold: 0.25
  auto_save_successful: true
rag:
  enabled: true
  embedding_model: all-MiniLM-L6-v2
  vector_db_path: data/agent_results/rag_exploits.pkl
  top_k: 5
  similarity_threshold: 0.5
skill_library:
  enabled: true
  path: data/agent_results/skill_library.json
  max_failures: 3
  auto_save: true
  prioritize_cached: true
